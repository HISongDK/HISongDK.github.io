---
title: OOP | 原型
tags: oop
categories:
  - 随敲
  - JavaScript面向对象编程指南
date: 2021-09-25 12:37:34
---

在本章中，我们将着重介绍函数对象中的原型（prototype）属性。对于 JavaScript 的学习来说，理解原型的工作原理是非常重要的一环，毕竟，它的对象模型是完全基于圆形的。当然，圆形其实不难理解，只不过由于这是个全新的概念，我们接受起来需要一点时间而已。事实上这东西在 JavaScript 中几乎无所不在（闭包除外），只要我们“领悟”了其中原理，一切都会显得格外简单明了了。而且在之后的内容中，本书会围绕着原型展开大量的示例演示，一边巩固并加深对这一概念的熟悉程度。

本章将要讨论以下话题。

- 每个函授都有一个 prototype 属性，该属性所存储的就是原型对象。
- 为原型对象添加属性。
- 使用原型对象中的新增属性。
- 区别对象自身属性与原型属性。
- `__proto__`,用于保存各对象原型的神秘链接。
- 介绍原型方法，例如 isPrototypeOf()、hasOwnProperty()、propertyIsEnumerable()。
- 如何（利用原型）强化数组或字符串这样的内建对象。

## 原型属性

在 JavaScript 中，函数本身也是一个包含了方法和属性的对象。经过之前的学习，相信我们对它的一些方法（如 apply()和 call()）及属性（如 length 和 constructor）并不陌生。接下来，我们要介绍的是函数对象的另一个属性——prototype。

众所周知，<!-- 其实我不是很知道 -->只要我们想下面这样简单地定义一个函数 foo(),就可以像访问其他对象一样访问该函数的属性：

```js
function foo(a, b) {
  return a * b;
}
foo.length; // 2
foo.constructor; // Function()
```

其实这些（在函数定义时被创建的）属性就包括了 prototype 属性，它的初始值是一个空对象。

```js
typeof foo.prototype;
// 'object'
```

当然我们也可以自己添加该属性，就像这样：

```js
foo.prototype = {};
```

我们也可以赋予这个空对象一些方法和属性，这并不会对 foo 函数本身造成什么影响，只是不能被用作构造器罢了。

## 利用原型添加方法和属性

在第 4 章中，我们已经学习了如何定义构造器函数，并用它来新建（构造）对象。这种做法的主要意图是通过 new 操作符调用函数，以达到访问对象 this 值的目的，然后，构造器就可以将它创建的新对象返回给我们。这样，我们就有了赋予新建对象一定功能（即为其添加属性和方法）的方法。

下面，让我们通过一个具体的构造器函数 Gadget()，来看看它是如何在新建对象是添加属性和方法的。

```js
function Gadget(name, color) {
  this.name = name;
  this.color = color;
  this.whatAreYou = function () {
    return 'I am a ' + this.color + ' ' + this.name;
  };
}
```

添加属性和方法还有另一种方式，即通过构造器函数的 prototype 属性来增加该构造器所能提供的功能。现在就让我们来给上面的构造器增加两个属性（即 price 和 rating）和一个方法（即 个体 Info()）。由于 prototype 属性包含的是一个对象，所以我们可以这样：

```ts
Gadget.prototype.price = 100;
Gadget.prototype.rating = 3;
Gadget.prototype.getInfo = function () {
  return 'Rating: ' + this.rating + ', price' + this.price;
};
```

如果不想将他们逐一添加到原型对象中去,也可以另外定义一个对象，然后将其覆盖到之前的原型上：

```js
Gadget.prototype = {
  price:100,
  rating:3,
  getInfo:function () {
    retrurn 'rating: ' + this.rating + ', price' + this.price
  }
}
```

### 使用原型的方法和属性

在向原型对象中添加完所有的方法和属性后，就可以直接用该构造器创建新对象了。例如，我们用 Gadget() 来创建一个 newtoy 对象，然后，就可以访问之前所定义的那些属性和方法了。

```js
var newtoy = new Gadget('webcam', 'black');

newtoy.name // "webcam"
newtoy.color // "black"
newtoy.whatAreYou // "I am a black webcam"

newtoy.price // 100
newtoy.rating // 3
newtoy.getInfo // "Rating: 3,price: 100"
```

对于原型来说，最重要的是我们要理解它的“驻留（live)”概念。
